---
import type { Lang } from '../i18n/strings';
import LanguageSwitch from '../components/LanguageSwitch.astro';
import { UI, t } from '../i18n/strings';

const { lang, title } = Astro.props as { lang: Lang; title?: string };
const pageTitle = title ? `${title} — ${UI.brand}` : UI.brand;
---

<!doctype html>
<html lang={lang}>
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="generator" content={Astro.generator} />
		<title>{pageTitle}</title>
	</head>
	<body>
		<header class="topbar">
			<div class="container topbar__inner">
				<div class="topbar__right">
					<span class="status" aria-label={t(UI.status.openForWork, lang)}>
						<span class="status__dot" aria-hidden="true"></span>
						<span class="status__text">{t(UI.status.openForWork, lang)}</span>
					</span>
					<a class="mailTop" href="mailto:poligorn.me@gmail.com">
						<svg class="mailTop__icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" focusable="false">
							<path
								fill="currentColor"
								d="M4 6.75A2.75 2.75 0 0 1 6.75 4h10.5A2.75 2.75 0 0 1 20 6.75v10.5A2.75 2.75 0 0 1 17.25 20H6.75A2.75 2.75 0 0 1 4 17.25V6.75Zm2.75-.75a.75.75 0 0 0-.75.75v.11l6 4.2 6-4.2v-.11a.75.75 0 0 0-.75-.75H6.75Zm11.25 2.7-5.57 3.9a.75.75 0 0 1-.86 0L6 8.7v8.55c0 .41.34.75.75.75h10.5c.41 0 .75-.34.75-.75V8.7Z"
							/>
						</svg>
						<span class="mailTop__text">{t(UI.topbar.contactMe, lang)}</span>
					</a>
					<LanguageSwitch lang={lang} />
				</div>
			</div>
		</header>

		<main class="main">
			<div class="container">
				<slot />
			</div>
		</main>

		<footer class="footer">
			<div class="container footer__inner">
				<div class="muted">© {new Date().getFullYear()} {UI.brand}</div>
			</div>
		</footer>

		<script is:inline>
			(() => {
				try {
					localStorage.setItem('poligorn_lang', '{lang}');
				} catch (e) {}
			})();
		</script>
	</body>
</html>

<style>
	:global(*) {
		box-sizing: border-box;
	}

	:global(html) {
		color-scheme: dark;
		background: #0b0e14;
	}

	:global(body) {
		margin: 0;
		font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
		color: rgba(255, 255, 255, 0.92);
		line-height: 1.55;
		position: relative;
	}

	:global(body)::before {
		content: '';
		position: fixed;
		inset: 0;
		pointer-events: none;
		z-index: 0;
		background-image:
			linear-gradient(to right, rgba(255, 255, 255, 0.06) 1px, transparent 1px),
			linear-gradient(to bottom, rgba(255, 255, 255, 0.06) 1px, transparent 1px);
		background-size: 120px 120px;
		opacity: 0.35;
		/* subtle vignette so the grid doesn't compete with content */
		mask-image: radial-gradient(circle at 30% 10%, rgba(0, 0, 0, 0.85), rgba(0, 0, 0, 0.15) 55%, rgba(0, 0, 0, 0) 80%);
	}

	:global(body)::after {
		content: '';
		position: fixed;
		inset: 0;
		pointer-events: none;
		z-index: 0;
		background: radial-gradient(circle at 20% 10%, rgba(255, 255, 255, 0.05), transparent 55%),
			radial-gradient(circle at 80% 90%, rgba(255, 255, 255, 0.03), transparent 50%);
	}

	/* ensure content is above the background grid */
	:global(body) > * {
		position: relative;
		z-index: 1;
	}

	:global(a) {
		color: inherit;
	}

	.container {
		width: min(1280px, calc(100% - 44px));
		margin: 0 auto;
	}

	.topbar {
		padding: 18px 0 6px;
	}

	.topbar__inner {
		display: flex;
		align-items: center;
		justify-content: flex-end;
		gap: 16px;
	}

	.topbar__right {
		display: flex;
		align-items: center;
		gap: 8px;
	}

	.mailTop {
		display: inline-flex;
		align-items: center;
		gap: 10px;
		height: 40px;
		padding: 0 12px;
		border-radius: 10px;
		text-decoration: none;
		border: 1px solid rgba(255, 255, 255, 0.12);
		background: rgba(255, 255, 255, 0.03);
		color: rgba(255, 255, 255, 0.86);
	}

	.mailTop:hover {
		border-color: rgba(255, 255, 255, 0.24);
	}

	.mailTop:focus-visible {
		outline: 2px solid rgba(130, 190, 255, 0.9);
		outline-offset: 2px;
	}

	.mailTop__icon {
		opacity: 0.9;
	}

	.mailTop__text {
		font-size: 14px;
		letter-spacing: 0.01em;
		white-space: nowrap;
	}

	.status {
		display: none;
		height: 40px;
		align-items: center;
		padding: 0 12px;
		border-radius: 999px;
		border: 1px solid rgba(255, 255, 255, 0.14);
		background: rgba(255, 255, 255, 0.03);
		color: rgba(255, 255, 255, 0.76);
		font-size: 14px;
		white-space: nowrap;
		gap: 10px;
	}

	.status__dot {
		width: 8px;
		height: 8px;
		border-radius: 999px;
		background: rgba(110, 255, 170, 0.92);
		box-shadow: 0 0 0 0 rgba(110, 255, 170, 0.55);
		animation: statusPulse 1.8s ease-in-out infinite;
	}

	@keyframes statusPulse {
		0% {
			box-shadow: 0 0 0 0 rgba(110, 255, 170, 0.48);
		}
		70% {
			box-shadow: 0 0 0 8px rgba(110, 255, 170, 0);
		}
		100% {
			box-shadow: 0 0 0 0 rgba(110, 255, 170, 0);
		}
	}

	@media (prefers-reduced-motion: reduce) {
		.status__dot {
			animation: none;
			box-shadow: none;
		}
	}

	.main {
		padding: 20px 0 44px;
	}

	.footer {
		padding: 24px 0 34px;
	}

	.footer__inner {
		display: flex;
		justify-content: space-between;
		align-items: center;
	}

	.muted {
		color: rgba(255, 255, 255, 0.6);
		font-size: 14px;
	}

	@media (min-width: 860px) {
		.status {
			display: inline-flex;
		}
	}

	@media (max-width: 520px) {
		.mailTop__text {
			display: none;
		}
		.mailTop {
			width: 40px;
			justify-content: center;
			padding: 0;
		}
	}
</style>


